<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login & Dashboard</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <script src="api.js" defer></script>
</head>
<body>
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Login Section -->
    <div id="loginSection" class="login-view">
        <div class="login-container">
            <div class="login-header">
                <div style="margin-bottom: 20px; display: inline-block;">
                    <div style="width: 80px; height: 80px; background: var(--gradient-primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                        <i class="fas fa-user-shield" style="font-size: 35px; color: white;"></i>
                    </div>
                </div>
                <h2>Admin Login</h2>
                <p>Please sign in to access the dashboard</p>
            </div>
            <form id="loginForm">
                <div class="input-group">
                    <label for="adminUsername" style="text-align: left; display: block;"><i class="fas fa-user-circle" style="margin-right: 6px;"></i>Username</label>
                    <div style="position: relative;">
                        <i class="fas fa-user" style="position: absolute; left: 14px; top: 50%; transform: translateY(-50%); color: #aaa;"></i>
                        <input type="text" id="adminUsername" class="input-field" style="padding-left: 40px;" placeholder="Enter your username" required autocomplete="username">
                    </div>
                </div>
                <div class="input-group">
                    <label for="adminPassword" style="text-align: left; display: block;"><i class="fas fa-lock" style="margin-right: 6px;"></i>Password</label>
                    <div style="position: relative;">
                        <i class="fas fa-key" style="position: absolute; left: 14px; top: 50%; transform: translateY(-50%); color: #aaa;"></i>
                        <input type="password" id="adminPassword" class="input-field" style="padding-left: 40px;" placeholder="Enter your password" required autocomplete="current-password">
                    </div>
                </div>
                <button type="submit" id="loginBtn" class="btn btn-primary btn-full" style="margin-top: 15px; padding: 16px;">
                    <i class="fas fa-sign-in-alt" style="margin-right: 10px;"></i>
                    <span id="loginBtnText">Sign In</span>
                </button>
                <div id="loginStatus" class="status-message" style="text-align: left;"></div>
            </form>
        </div>
    </div>

    <!-- Dashboard Section -->
    <div id="dashboardSection" style="display:none;">
        <div class="container">
            <div class="dashboard-header">
                <h1 class="dashboard-title"><i class="fas fa-th-large" style="margin-right: 12px; color: var(--secondary-color);"></i>Admin Dashboard</h1>
                <div class="user-info">
                    <span><i class="fas fa-user-shield" style="margin-right: 8px; color: var(--primary-color);"></i>Welcome, <strong id="adminName">Admin</strong></span>
                    <button onclick="logout()" class="btn btn-outline"><i class="fas fa-sign-out-alt" style="margin-right: 8px;"></i>Logout</button>
                </div>
            </div>

            <div class="admin-actions">
                <!-- Register Student -->
                <div class="card">
                    <div class="card-header">
                        <h3><div class="card-icon"><i class="fas fa-user-plus"></i></div>Register Student</h3>
                        <p>Add a new student to the system</p>
                    </div>
                    <form id="registerStudentForm">
                        <div class="form-group">
                            <label for="studentName"><i class="fas fa-user" style="margin-right: 6px;"></i>Full Name</label>
                            <input type="text" id="studentName" class="input-field" placeholder="Enter student's full name" required>
                        </div>
                        <div class="form-group">
                            <label for="studentReg"><i class="fas fa-id-card" style="margin-right: 6px;"></i>Registration Number</label>
                            <input type="text" id="studentReg" class="input-field" placeholder="Enter registration number" required>
                        </div>
                        <div class="form-group">
                            <label for="studentCourse"><i class="fas fa-book" style="margin-right: 6px;"></i>Course</label>
                            <input type="text" id="studentCourse" class="input-field" placeholder="Enter course name" required>
                        </div>
                        <div class="form-group">
                            <label for="studentYearSemester"><i class="fas fa-calendar-alt" style="margin-right: 6px;"></i>Level of Study</label>
                            <input type="text" id="studentYearSemester" class="input-field" placeholder="e.g., Year 2 Semester 1" required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="studentNationalId"><i class="fas fa-id-card" style="margin-right: 6px;"></i>National ID</label>
                                <input type="text" id="studentNationalId" class="input-field" placeholder="Enter national ID">
                            </div>
                            <div class="form-group">
                                <label for="studentBirthCert"><i class="fas fa-certificate" style="margin-right: 6px;"></i>Birth Certificate</label>
                                <input type="text" id="studentBirthCert" class="input-field" placeholder="Enter birth certificate number">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="studentDob"><i class="fas fa-birthday-cake" style="margin-right: 6px;"></i>Date of Birth</label>
                                <input type="date" id="studentDob" class="input-field">
                            </div>
                            <div class="form-group">
                                <label for="studentPassword"><i class="fas fa-lock" style="margin-right: 6px;"></i>Password</label>
                                <input type="password" id="studentPassword" class="input-field" placeholder="Enter password">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="studentPhoto"><i class="fas fa-camera" style="margin-right: 6px;"></i>Student Photo</label>
                            <input type="file" id="studentPhoto" class="input-field" accept="image/*">
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">
                            <i class="fas fa-user-check" style="margin-right: 8px;"></i>
                            <span class="btn-text">Register Student</span>
                        </button>
                        <div class="status-message" id="registerStatus"></div>
                    </form>
                </div>

                <!-- Deregister Student -->
                <div class="card">
                    <div class="card-header">
                        <h3><div class="card-icon"><i class="fas fa-user-minus"></i></div>Deregister Student</h3>
                        <p>Remove a student from the system</p>
                    </div>
                    <form id="deregisterStudentForm">
                        <div class="form-group">
                            <label for="deregStudentReg"><i class="fas fa-id-card" style="margin-right: 6px;"></i>Registration Number</label>
                            <input type="text" id="deregStudentReg" class="input-field" placeholder="Enter registration number" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">
                            <i class="fas fa-user-times" style="margin-right: 8px;"></i>
                            <span class="btn-text">Deregister Student</span>
                        </button>
                        <div class="status-message" id="deregisterStatus"></div>
                    </form>
                </div>

                <!-- Grant Academic Leave -->
                <div class="card">
                    <div class="card-header">
                        <h3><div class="card-icon"><i class="fas fa-calendar-times"></i></div>Grant Academic Leave</h3>
                        <p>Grant academic leave to a student</p>
                    </div>
                    <form id="grantLeaveForm">
                        <div class="form-group">
                            <label for="leaveStudentReg"><i class="fas fa-id-card" style="margin-right: 6px;"></i>Registration Number</label>
                            <input type="text" id="leaveStudentReg" class="input-field" placeholder="Enter registration number" required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="leaveStartDate"><i class="fas fa-calendar-alt" style="margin-right: 6px;"></i>Start Date</label>
                                <input type="date" id="leaveStartDate" class="input-field" required>
                            </div>
                            <div class="form-group">
                                <label for="leaveEndDate"><i class="fas fa-calendar-check" style="margin-right: 6px;"></i>End Date</label>
                                <input type="date" id="leaveEndDate" class="input-field" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="leaveReason"><i class="fas fa-comment" style="margin-right: 6px;"></i>Reason</label>
                            <textarea id="leaveReason" class="input-field" placeholder="Enter reason for academic leave" rows="3" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">
                            <i class="fas fa-check-circle" style="margin-right: 8px;"></i>
                            <span class="btn-text">Grant Leave</span>
                        </button>
                        <div class="status-message" id="grantLeaveStatus"></div>
                    </form>
                </div>

                <!-- Register Units for Student -->
                <div class="card">
                    <div class="card-header">
                        <h3><div class="card-icon"><i class="fas fa-book-open"></i></div>Register Units</h3>
                        <p>Register course units for a student</p>
                    </div>
                    <form id="registerUnitsForm">
                        <div class="form-group">
                            <label for="unitStudentReg"><i class="fas fa-id-card" style="margin-right: 6px;"></i>Registration Number</label>
                            <input type="text" id="unitStudentReg" class="input-field" placeholder="Enter registration number" required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="unitName"><i class="fas fa-book" style="margin-right: 6px;"></i>Unit Name</label>
                                <input type="text" id="unitName" class="input-field" placeholder="Enter unit name" required>
                            </div>
                            <div class="form-group">
                                <label for="unitCode"><i class="fas fa-hashtag" style="margin-right: 6px;"></i>Unit Code</label>
                                <input type="text" id="unitCode" class="input-field" placeholder="Enter unit code" required>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">
                            <i class="fas fa-plus-circle" style="margin-right: 8px;"></i>
                            <span class="btn-text">Register Unit</span>
                        </button>
                        <div class="status-message" id="unitStatus"></div>
                    </form>
                </div>

                <!-- Promote Student -->
                <div class="card">
                    <div class="card-header">
                        <h3><div class="card-icon"><i class="fas fa-arrow-up"></i></div>Promote Student</h3>
                        <p>Promote student to next level</p>
                    </div>
                    <form id="promoteStudentForm">
                        <div class="form-group">
                            <label for="promoteStudentReg"><i class="fas fa-id-card" style="margin-right: 6px;"></i>Registration Number</label>
                            <input type="text" id="promoteStudentReg" class="input-field" placeholder="Enter registration number" required>
                        </div>
                        <div class="form-group">
                            <label for="newYearSemester"><i class="fas fa-calendar-alt" style="margin-right: 6px;"></i>New Year/Semester</label>
                            <input type="text" id="newYearSemester" class="input-field" placeholder="e.g., Year 3 Semester 1" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">
                            <i class="fas fa-level-up-alt" style="margin-right: 8px;"></i>
                            <span class="btn-text">Promote Student</span>
                        </button>
                        <div class="status-message" id="promoteStatus"></div>
                    </form>
                </div>

                <!-- Re-admit Student -->
                <div class="card">
                    <div class="card-header">
                        <h3><div class="card-icon"><i class="fas fa-user-check"></i></div>Re-admit Student</h3>
                        <p>Re-admit a student from academic leave</p>
                    </div>
                    <form id="readmitStudentForm">
                        <div class="form-group">
                            <label for="readmitStudentReg"><i class="fas fa-id-card" style="margin-right: 6px;"></i>Registration Number</label>
                            <input type="text" id="readmitStudentReg" class="input-field" placeholder="Enter registration number" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">
                            <i class="fas fa-undo" style="margin-right: 8px;"></i>
                            <span class="btn-text">Re-admit Student</span>
                        </button>
                        <div class="status-message" id="readmitStatus"></div>
                    </form>
                </div>

                <!-- Upload Exam Card -->
                <div class="card">
                    <div class="card-header">
                        <h3><div class="card-icon"><i class="fas fa-id-card"></i></div>Upload Exam Card</h3>
                        <p>Upload exam card for a student</p>
                    </div>
                    <form id="examCardForm">
                        <div class="form-group">
                            <label for="examCardStudentReg"><i class="fas fa-id-card" style="margin-right: 6px;"></i>Registration Number</label>
                            <input type="text" id="examCardStudentReg" class="input-field" placeholder="Enter registration number" required>
                        </div>
                        <div class="form-group">
                            <label for="examCardFile"><i class="fas fa-file-pdf" style="margin-right: 6px;"></i>Exam Card File</label>
                            <input type="file" id="examCardFile" class="input-field" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">
                            <i class="fas fa-upload" style="margin-right: 8px;"></i>
                            <span class="btn-text">Upload Exam Card</span>
                        </button>
                        <div class="status-message" id="examCardStatus"></div>
                    </form>
                </div>

                <!-- Manage Fees -->
                <div class="card">
                    <div class="card-header">
                        <h3><div class="card-icon"><i class="fas fa-money-bill-wave"></i></div>Manage Fees</h3>
                        <p>Update student fee information</p>
                    </div>
                    <form id="feesForm">
                        <div class="form-group">
                            <label for="feesStudentReg"><i class="fas fa-id-card" style="margin-right: 6px;"></i>Registration Number</label>
                            <input type="text" id="feesStudentReg" class="input-field" placeholder="Enter registration number" required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="semesterFee"><i class="fas fa-dollar-sign" style="margin-right: 6px;"></i>Semester Fee</label>
                                <input type="number" id="semesterFee" class="input-field" placeholder="Enter semester fee" required>
                            </div>
                            <div class="form-group">
                                <label for="feeBalance"><i class="fas fa-balance-scale" style="margin-right: 6px;"></i>Fee Balance</label>
                                <input type="number" id="feeBalance" class="input-field" placeholder="Enter fee balance" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="totalPaid"><i class="fas fa-check-circle" style="margin-right: 6px;"></i>Total Paid</label>
                            <input type="number" id="totalPaid" class="input-field" placeholder="Enter total paid" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">
                            <i class="fas fa-save" style="margin-right: 8px;"></i>
                            <span class="btn-text">Update Fees</span>
                        </button>
                        <div class="status-message" id="feesStatus"></div>
                    </form>
                </div>

                <!-- Upload Finance Document -->
                <div class="card">
                    <div class="card-header">
                        <h3><div class="card-icon"><i class="fas fa-file-invoice-dollar"></i></div>Finance Document</h3>
                        <p>Upload financial statement or receipt</p>
                    </div>
                    <form id="financeForm">
                        <div class="form-group">
                            <label for="financeStudentReg"><i class="fas fa-id-card" style="margin-right: 6px;"></i>Registration Number</label>
                            <input type="text" id="financeStudentReg" class="input-field" placeholder="Enter registration number" required>
                        </div>
                        <div class="form-group">
                            <label for="documentType"><i class="fas fa-file-alt" style="margin-right: 6px;"></i>Document Type</label>
                            <select id="documentType" class="input-field" required>
                                <option value="statement">Statement</option>
                                <option value="receipt">Receipt</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="financeFile"><i class="fas fa-file-upload" style="margin-right: 6px;"></i>Document File</label>
                            <input type="file" id="financeFile" class="input-field" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">
                            <i class="fas fa-upload" style="margin-right: 8px;"></i>
                            <span class="btn-text">Upload Document</span>
                        </button>
                        <div class="status-message" id="financeStatus"></div>
                    </form>
                </div>

                <!-- View Students -->
                <div class="card" id="viewStudentsCard">
                    <div class="card-header">
                        <h3><div class="card-icon"><i class="fas fa-users"></i></div>View Students</h3>
                        <p>Browse and manage all registered students</p>
                    </div>
                    <div class="card-content">
                        <div class="search-filter-container">
                            <div class="search-box">
                                <i class="fas fa-search" style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--text-secondary);"></i>
                                <input type="text" id="studentSearch" class="input-field" style="padding-left: 40px;" placeholder="Search by name or registration number" oninput="searchStudents(this.value)">
                            </div>
                            <div class="filter-controls">
                                <select id="statusFilter" class="input-field" onchange="filterStudents()" style="width: 150px;">
                                    <option value="all">All Status</option>
                                    <option value="active">Active</option>
                                    <option value="on-leave">On Leave</option>
                                    <option value="inactive">Inactive</option>
                                </select>
                                <button class="btn btn-outline" onclick="fetchStudents()" title="Refresh Students">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                            </div>
                        </div>
                        <div id="studentsTableContainer" class="students-table-container">
                            <!-- Table will be rendered here by JS -->
                        </div>
                    </div>
                </div>

                <!-- Upload Results -->
                <div class="card">
                    <div class="card-header">
                        <h3><div class="card-icon"><i class="fas fa-chart-bar"></i></div>Upload Results</h3>
                        <p>Upload semester results for a student</p>
                    </div>
                    <form id="resultsForm">
                        <div class="form-group">
                            <label for="resultsStudentReg"><i class="fas fa-id-card" style="margin-right: 6px;"></i>Registration Number</label>
                            <input type="text" id="resultsStudentReg" class="input-field" placeholder="Enter registration number" required>
                        </div>
                        <div class="form-group">
                            <label for="resultsSemester"><i class="fas fa-calendar-alt" style="margin-right: 6px;"></i>Semester</label>
                            <select id="resultsSemester" class="input-field" required>
                                <option value="1">Semester 1</option>
                                <option value="2">Semester 2</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="resultsData"><i class="fas fa-list-alt" style="margin-right: 6px;"></i>Results Data (JSON)</label>
                            <textarea id="resultsData" class="input-field" rows="4" placeholder='{"unit1": "A", "unit2": "B+"}' required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">
                            <i class="fas fa-upload" style="margin-right: 8px;"></i>
                            <span class="btn-text">Upload Results</span>
                        </button>
                        <div class="status-message" id="resultsStatus"></div>
                    </form>
                </div>

                <!-- Upload Timetable -->
                <div class="card">
                    <div class="card-header">
                        <h3><div class="card-icon"><i class="fas fa-calendar-week"></i></div>Upload Timetable</h3>
                        <p>Upload semester timetable for a student</p>
                    </div>
                    <form id="timetableForm">
                        <div class="form-group">
                            <label for="timetableStudentReg"><i class="fas fa-id-card" style="margin-right: 6px;"></i>Registration Number</label>
                            <input type="text" id="timetableStudentReg" class="input-field" placeholder="Enter registration number" required>
                        </div>
                        <div class="form-group">
                            <label for="timetableSemester"><i class="fas fa-calendar-alt" style="margin-right: 6px;"></i>Semester</label>
                            <select id="timetableSemester" class="input-field" required>
                                <option value="1">Semester 1</option>
                                <option value="2">Semester 2</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="timetableData"><i class="fas fa-list-alt" style="margin-right: 6px;"></i>Timetable Data (JSON)</label>
                            <textarea id="timetableData" class="input-field" rows="4" placeholder='{"monday": [{"time": "8:00-10:00", "unit": "Math"}]}' required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">
                            <i class="fas fa-upload" style="margin-right: 8px;"></i>
                            <span class="btn-text">Upload Timetable</span>
                        </button>
                        <div class="status-message" id="timetableStatus"></div>
                    </form>
                </div>
            </div>
        </div>
    </div>

  
</body>
</html>